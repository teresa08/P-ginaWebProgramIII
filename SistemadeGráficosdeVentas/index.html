<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sistema de An치lisis de Ventas</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/3.9.1/chart.min.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
        }

        .card {
            background: white;
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
            padding: 30px;
            margin-bottom: 20px;
        }

        .header {
            display: flex;
            align-items: center;
            gap: 15px;
            margin-bottom: 30px;
            border-bottom: 3px solid #667eea;
            padding-bottom: 15px;
        }

        .header-icon {
            width: 40px;
            height: 40px;
            background: #667eea;
            border-radius: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 24px;
        }

        h1 {
            color: #333;
            font-size: 28px;
        }

        .form-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
            background: #f8f9fa;
            padding: 20px;
            border-radius: 10px;
        }

        .form-group {
            display: flex;
            flex-direction: column;
        }

        label {
            font-weight: 600;
            color: #555;
            margin-bottom: 8px;
            font-size: 14px;
        }

        select, input[type="checkbox"] {
            padding: 10px;
            border: 2px solid #ddd;
            border-radius: 8px;
            font-size: 14px;
            transition: all 0.3s;
        }

        select:focus {
            outline: none;
            border-color: #667eea;
            box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
        }

        .checkbox-group {
            display: flex;
            align-items: center;
            gap: 10px;
            padding-top: 25px;
        }

        input[type="checkbox"] {
            width: 20px;
            height: 20px;
            cursor: pointer;
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin-bottom: 30px;
        }

        .stat-card {
            padding: 20px;
            border-radius: 10px;
            border-left: 4px solid;
        }

        .stat-card.blue {
            background: #e3f2fd;
            border-color: #2196f3;
        }

        .stat-card.green {
            background: #e8f5e9;
            border-color: #4caf50;
        }

        .stat-card.purple {
            background: #f3e5f5;
            border-color: #9c27b0;
        }

        .stat-label {
            font-size: 13px;
            color: #666;
            font-weight: 600;
            margin-bottom: 8px;
        }

        .stat-value {
            font-size: 28px;
            font-weight: bold;
        }

        .stat-card.blue .stat-value {
            color: #2196f3;
        }

        .stat-card.green .stat-value {
            color: #4caf50;
        }

        .stat-card.purple .stat-value {
            color: #9c27b0;
        }

        .chart-container {
            position: relative;
            height: 400px;
            margin-bottom: 20px;
            width: 100%;
            overflow: hidden;
        }

        #salesChart {
            max-width: 100%;
            height: auto !important;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 20px;
        }

        thead {
            background: #f8f9fa;
        }

        th, td {
            padding: 12px;
            text-align: left;
            border-bottom: 1px solid #dee2e6;
        }

        th {
            font-weight: 600;
            color: #495057;
            font-size: 14px;
        }

        td {
            color: #212529;
        }

        .text-right {
            text-align: right;
        }

        tbody tr:hover {
            background: #f8f9fa;
        }

        .utility {
            color: #4caf50;
            font-weight: 600;
        }

        h2 {
            color: #333;
            margin-bottom: 15px;
            font-size: 22px;
        }

        @media (max-width: 768px) {
            .form-grid {
                grid-template-columns: 1fr;
            }
            
            h1 {
                font-size: 22px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="card">
            <div class="header">
                <div class="header-icon">游늵</div>
                <h1>Sistema de An치lisis de Ventas</h1>
            </div>

            <!-- Formulario de configuraci칩n -->
            <div class="form-grid">
                <div class="form-group">
                    <label for="dataSource">Fuente de Datos</label>
                    <select id="dataSource" onchange="updateChart()">
                        <option value="monthly">Ventas Mensuales</option>
                        <option value="categories">Ventas por Categor칤a</option>
                    </select>
                </div>

                <div class="form-group">
                    <label for="chartType">Tipo de Gr치fico</label>
                    <select id="chartType" onchange="updateChart()">
                        <option value="bar">Barras</option>
                        <option value="line">L칤neas</option>
                        <option value="pie">Circular</option>
                        <option value="doughnut">Dona</option>
                        <option value="radar">Radar</option>
                    </select>
                </div>

                <div class="form-group">
                    <div class="checkbox-group">
                        <input type="checkbox" id="showExpenses" onchange="updateChart()">
                        <label for="showExpenses" style="margin: 0;">Mostrar Gastos</label>
                    </div>
                </div>
            </div>

            <!-- Estad칤sticas -->
            <div class="stats-grid">
                <div class="stat-card blue">
                    <div class="stat-label">游늳 Total Ventas</div>
                    <div class="stat-value" id="totalSales">$0</div>
                </div>
                <div class="stat-card green">
                    <div class="stat-label">游눯 Promedio Mensual</div>
                    <div class="stat-value" id="avgSales">$0</div>
                </div>
                <div class="stat-card purple">
                    <div class="stat-label">游늶 Registros</div>
                    <div class="stat-value" id="recordCount">0</div>
                </div>
            </div>
        </div>

        <!-- Gr치fico -->
        <div class="card">
            <div class="chart-container">
                <canvas id="salesChart"></canvas>
            </div>
        </div>

        <!-- Tabla de datos -->
        <div class="card">
            <h2>Datos Detallados</h2>
            <div style="overflow-x: auto;">
                <table id="dataTable">
                    <thead id="tableHead"></thead>
                    <tbody id="tableBody"></tbody>
                </table>
            </div>
        </div>
    </div>

    <script>
        // Datos de la aplicaci칩n
        const salesData = {
            monthly: [
                { month: 'Enero', sales: 45000, expenses: 32000 },
                { month: 'Febrero', sales: 52000, expenses: 35000 },
                { month: 'Marzo', sales: 48000, expenses: 33000 },
                { month: 'Abril', sales: 61000, expenses: 38000 },
                { month: 'Mayo', sales: 55000, expenses: 36000 },
                { month: 'Junio', sales: 67000, expenses: 40000 },
                { month: 'Julio', sales: 72000, expenses: 42000 },
                { month: 'Agosto', sales: 68000, expenses: 41000 },
                { month: 'Septiembre', sales: 74000, expenses: 43000 },
                { month: 'Octubre', sales: 79000, expenses: 45000 },
                { month: 'Noviembre', sales: 85000, expenses: 47000 },
                { month: 'Diciembre', sales: 92000, expenses: 50000 }
            ],
            categories: [
                { name: 'Electr칩nicos', amount: 145000 },
                { name: 'Ropa', amount: 89000 },
                { name: 'Alimentos', amount: 123000 },
                { name: 'Hogar', amount: 76000 },
                { name: 'Deportes', amount: 54000 }
            ]
        };

        let chartInstance = null;

        function formatCurrency(value) {
            return '$' + value.toLocaleString();
        }

        function calculateTotal() {
            const dataSource = document.getElementById('dataSource').value;
            if (dataSource === 'monthly') {
                return salesData.monthly.reduce((sum, item) => sum + item.sales, 0);
            } else {
                return salesData.categories.reduce((sum, item) => sum + item.amount, 0);
            }
        }

        function updateStats() {
            const total = calculateTotal();
            const dataSource = document.getElementById('dataSource').value;
            const count = dataSource === 'monthly' ? salesData.monthly.length : salesData.categories.length;
            
            document.getElementById('totalSales').textContent = formatCurrency(total);
            document.getElementById('avgSales').textContent = formatCurrency(Math.round(total / 12));
            document.getElementById('recordCount').textContent = count;
        }

        function updateTable() {
            const dataSource = document.getElementById('dataSource').value;
            const tableHead = document.getElementById('tableHead');
            const tableBody = document.getElementById('tableBody');

            if (dataSource === 'monthly') {
                tableHead.innerHTML = `
                    <tr>
                        <th>Mes</th>
                        <th class="text-right">Ventas</th>
                        <th class="text-right">Gastos</th>
                        <th class="text-right">Utilidad</th>
                    </tr>
                `;
                
                tableBody.innerHTML = salesData.monthly.map(item => `
                    <tr>
                        <td>${item.month}</td>
                        <td class="text-right">${formatCurrency(item.sales)}</td>
                        <td class="text-right">${formatCurrency(item.expenses)}</td>
                        <td class="text-right utility">${formatCurrency(item.sales - item.expenses)}</td>
                    </tr>
                `).join('');
            } else {
                tableHead.innerHTML = `
                    <tr>
                        <th>Categor칤a</th>
                        <th class="text-right">Ventas</th>
                    </tr>
                `;
                
                tableBody.innerHTML = salesData.categories.map(item => `
                    <tr>
                        <td>${item.name}</td>
                        <td class="text-right">${formatCurrency(item.amount)}</td>
                    </tr>
                `).join('');
            }
        }

        function updateChart() {
            const dataSource = document.getElementById('dataSource').value;
            const chartType = document.getElementById('chartType').value;
            const showExpenses = document.getElementById('showExpenses').checked;
            const ctx = document.getElementById('salesChart').getContext('2d');

            // Destruir gr치fico anterior
            if (chartInstance) {
                chartInstance.destroy();
            }

            let labels, datasets;

            if (dataSource === 'monthly') {
                labels = salesData.monthly.map(item => item.month);
                datasets = [
                    {
                        label: 'Ventas ($)',
                        data: salesData.monthly.map(item => item.sales),
                        backgroundColor: 'rgba(59, 130, 246, 0.6)',
                        borderColor: 'rgba(59, 130, 246, 1)',
                        borderWidth: 2,
                        tension: 0.4
                    }
                ];

                if (showExpenses) {
                    datasets.push({
                        label: 'Gastos ($)',
                        data: salesData.monthly.map(item => item.expenses),
                        backgroundColor: 'rgba(239, 68, 68, 0.6)',
                        borderColor: 'rgba(239, 68, 68, 1)',
                        borderWidth: 2,
                        tension: 0.4
                    });
                }

                // Ocultar checkbox de gastos si no es mensual
                document.getElementById('showExpenses').parentElement.parentElement.style.display = 'block';
            } else {
                labels = salesData.categories.map(item => item.name);
                datasets = [
                    {
                        label: 'Ventas por Categor칤a ($)',
                        data: salesData.categories.map(item => item.amount),
                        backgroundColor: [
                            'rgba(59, 130, 246, 0.7)',
                            'rgba(16, 185, 129, 0.7)',
                            'rgba(245, 158, 11, 0.7)',
                            'rgba(139, 92, 246, 0.7)',
                            'rgba(236, 72, 153, 0.7)'
                        ],
                        borderColor: [
                            'rgba(59, 130, 246, 1)',
                            'rgba(16, 185, 129, 1)',
                            'rgba(245, 158, 11, 1)',
                            'rgba(139, 92, 246, 1)',
                            'rgba(236, 72, 153, 1)'
                        ],
                        borderWidth: 2
                    }
                ];

                document.getElementById('showExpenses').parentElement.parentElement.style.display = 'none';
            }

            // Crear nuevo gr치fico
            chartInstance = new Chart(ctx, {
                type: chartType,
                data: {
                    labels: labels,
                    datasets: datasets
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            display: true,
                            position: 'top',
                        },
                        title: {
                            display: true,
                            text: dataSource === 'monthly' ? 'An치lisis de Ventas Mensuales' : 'Ventas por Categor칤a',
                            font: {
                                size: 18,
                                weight: 'bold'
                            },
                            padding: 20
                        }
                    },
                    scales: (chartType !== 'pie' && chartType !== 'doughnut' && chartType !== 'radar') ? {
                        y: {
                            beginAtZero: true,
                            ticks: {
                                callback: function(value) {
                                    return formatCurrency(value);
                                }
                            }
                        }
                    } : {}
                }
            });

            updateStats();
            updateTable();
        }

        // Inicializar al cargar la p치gina
        window.onload = function() {
            updateChart();
        };
    </script>
</body>
</html>